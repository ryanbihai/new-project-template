# CLAUDE.md - 项目核心上下文与规则

欢迎加入 **简易任务管理系统** 项目。本文件是 AI 助手（Trae/Claude Code）的核心操作手册。
**AI 请注意：在每次会话开始时，必须先读取 `progress.md` 以掌握当前进度。随后根据用户具体需求，按需读取 `docs/` 下的相关规范文档（如涉及 UI 修改必读 `UI_GUIDELINES.md`，涉及数据必读 `DATA_SCHEMA.md`）。**

## 1. 项目概览 (Project Overview)
- **目标**: 构建一个极简、高效的任务管理 Web 应用。
- **核心功能**: 任务增删改查、优先级管理、状态看板。
- **当前阶段**: 请参考 `progress.md`。

## 2. 核心文档索引 (Documentation Index)
所有开发决策必须基于以下“真理来源”：

- **需求与流程**:
  - `docs/PRD.md`: 产品功能边界与非功能需求。
  - `docs/APP_FLOW.md`: 页面跳转逻辑与用户交互路径。
- **技术与规范**:
  - `docs/TECH_STACK.md`: 锁定的技术栈版本（Next.js 14, Tailwind, Shadcn UI）。
  - `docs/UI_GUIDELINES.md`: 视觉规范（色值、圆角、间距、字体）。
  - `docs/DATA_SCHEMA.md`: 数据结构定义（TypeScript Interface）。
  - `docs/QA_CHECKLIST.md`: **发布前必读**的验证清单。
- **执行计划**:
  - `docs/PLAN.md`: 分步骤实施计划。
- **状态同步**:
  - `progress.md`: 项目进度跟踪（**每次任务后必更**）。
  - `lessons.md`: 避坑指南与经验教训。
  - `.traerules`: Trae 专属规则配置。

## 3. 常用命令 (Common Commands)

### 开发 (Development)
- **启动开发服务器**:
  ```bash
  npm run dev
  ```
- **构建生产版本**:
  ```bash
  npm run build
  ```
- **运行 Lint 检查**:
  ```bash
  npm run lint
  ```

## 4. 编码规范 (Coding Standards)

### 4.1 技术栈守则
- **框架**: Next.js 14 (App Router), TypeScript.
- **样式**: Tailwind CSS (严禁使用内联 style 或 CSS Modules，除非绝对必要).
- **图标**: Lucide React.
- **组件库**: Shadcn UI (基于 Radix UI).
- **状态管理**: 优先使用 React Hooks (useState, useReducer) 和 Context API.

### 4.2 命名规范
- **文件/目录**: 使用 `kebab-case` (如 `task-card.tsx`, `components/ui/`).
- **组件**: 使用 `PascalCase` (如 `TaskCard`, `UserProfile`).
- **函数/变量**: 使用 `camelCase` (如 `fetchTasks`, `isLoading`).
- **类型/接口**: 使用 `PascalCase` (如 `Task`, `UserSettings`).

### 4.3 代码风格
- **注释**: 所有注释必须使用 **中文**。
- **类型安全**: 严禁使用 `any`，必须定义明确的 Interface 或 Type。
- **组件结构**:
  ```tsx
  // 导入顺序: React -> 第三方库 -> 本地组件 -> 样式/类型
  import { useState } from 'react';
  import { Button } from '@/components/ui/button';
  import { Task } from '@/types';
  
  interface Props { ... }
  
  export function ComponentName({ prop }: Props) {
    // Hooks
    // Effects
    // Handlers
    // Render
  }
  ```

## 5. Vibe Coding 协作法则
1.  **文档驱动**: 在写代码前，先确认 `docs/` 下的文档是否支持该功能。如果文档未定义，先询问用户。
2.  **原子化提交**: 每次只完成 `docs/PLAN.md` 中的一个子步骤，不要一次性写完所有功能。
3.  **自我修正**: 如果遇到错误，先检查 `lessons.md` 是否有类似记录。修复后，将新教训写入 `lessons.md`。
4.  **状态同步**: 任务完成后，**必须**主动提议更新 `progress.md`。

## 6. 错误处理与调试循环 (Debugging Loop)
当遇到 Bug 时，请严格遵循以下步骤，而不是盲目尝试：
1.  **阅读错误 (Read)**: 仔细阅读错误堆栈，定位具体的文件和行号。
2.  **定位 (Locate)**: 检查报错位置的上下文代码。
3.  **假设 (Hypothesize)**: 基于 `docs/TECH_STACK.md` 检查是否使用了错误的 API 版本。
4.  **上下文 (Context)**: 向用户汇报错误时，提供完整的错误信息和相关代码片段。
5.  **验证 (Verify)**: 修复后，必须重新运行相关流程，确保 Bug 彻底解决且未引入新问题。

## 7. 安全与隐私 (Security)
- **零信任前端**: 永远不要在前端代码中硬编码 API Key 或敏感 Secret。
- **输入清洗**: 假设所有用户输入都是恶意的，必须进行校验。
